extends ../headers/base

block content
    style.
        .text-center {
        text-align: center;
        }

        .p-6 {
        padding: 3.5rem; /* Custom padding since Bootstrap only goes up to p-5 */
        }

        .btn {
        display: inline-block;
        font-weight: 400;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        user-select: none;
        border: 1px solid transparent;
        padding: 0.375rem 0.75rem;
        font-size: 1rem;
        line-height: 1.5;
        border-radius: 0.25rem;
        transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out,
            border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        .btn-primary {
        color: #fff;
        background-color: #007bff;
        border-color: #007bff;
        }

        .btn-primary:hover {
        background-color: #0069d9;
        border-color: #0062cc;
        }

        .reader-container {
            //- height: 100vh;
            display: flex;
            justify-content: center; /* horizontal center */
            align-items: center;     /* vertical center */
            padding: 2rem 0;
        }

        #reader {
            width: 500px;
        }


    script(src="https://unpkg.com/html5-qrcode@2.0.9/dist/html5-qrcode.min.js")
    div.reader-container
        div(style="width: 500px;" id="reader")
    
    div.text-center.p-6
        button.btn.btn-primary#start-scan Start Scan


        script.
            document.addEventListener('DOMContentLoaded', (event) => {
                const html5QrcodeScanner = new Html5QrcodeScanner("reader", { fps: 10, qrbox: 250 });
                const startScanButton = document.getElementById('start-scan');

                function onScanSuccess(decodedText, decodedResult) {
                    console.log(`Code scanned = ${decodedText}`, decodedResult);
                    alert(`Scanned QR Code: ${decodedText}`);
                    let cleanedPath = decodedText.replace(/^.*\/checkTicket\//, '');
                    window.location.href = `checkTicket/${cleanedPath}`;
                }


                startScanButton.addEventListener('click', () => {
                    html5QrcodeScanner.render(onScanSuccess);
                });
            });
